---
title: Docker 常用命令
date: 2023-07-12 13:06:21
permalink: /pages/docker/
---

Docker *初级用法*和一个**解压缩**工具（像 7z, winrar）一样

主要内容是「容器」和「镜像」，镜像可以看作压缩好的压缩包，而容器可以看作每次从压缩包里解压出来的文件，每次解压出来的文件都是独立的，对文件的操作也不会影响压缩包

> <del>其实就是类和实例的关系，但我想换个比喻</del>
> 不说类和实例的关系还是因为，镜像里是有具体内容的，不像类那样说抽象的定义

## 安装

首先，安装。我还是不习惯用桌面版 docker desktop 的，所以现在要用也会到 WSL 里面用原生的 docker。

安装方法去官网跟着步骤走就行不多说。提一嘴的是，官网直接点进去是 docker desktop 的安装（包括 linux 中使用 desktop），原生的 docker 在 engine 页面里 https://docs.docker.com/engine/install/

WSL2 中安装 docker 也可以看这篇文章：[wsl2安装Linux原生Docker](https://zhuanlan.zhihu.com/p/421998834)

启动 docker 时 `service docker start`，这时如果报错 Failed to start docker.service: Interactive authentication required. 可能是已经开启过了，重启一下即可 `service docker restart`

## 镜像命令

- 查看镜像 `docker images`
- 搜索镜像 `docker search imageName`
- 下载镜像 `docker pull xxx`
- 删除镜像 `docker rmi imageName`
- 更新镜像内容：
  在镜像容器内操作完后，主机上 `docker commit -m=“xxx” -a="xxx" containerId newImageName` -a是作者  
- 构建镜像 `docker build -t ImageName path` path 是 Dockerfile 所在目录

## 容器命令

- 启动容器
```bash
docker run -itd ubuntu:15.10 /bin/bash
-i 允许标准输入
-t 指定一个终端
-d 后台模式，返回容器 id
-P 容器内用的端口随机映射到主机
-p 外端口:内端口 指定映射（外端口可以填ip）默认tcp端口，端口/udp udp端口

docker exec -it 243c32535da7 /bin/bash
exit
```

- 查看容器 `docker ps -a`
- 查看容器标准输出 `docker logs id`
- 停止容器 `docker stop id`
- 重启容器 `docker restart id`
- 删除容器 `docker rm -f id`
	- 删除所有终止的容器 `docker container prune`
- 查看容器端口映射 `docker port id`
- 查看容器内进程 `docker top id`


进阶一点的用法像 Dockerfile、Compose 这些之后用到再记